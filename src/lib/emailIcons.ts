// Email-safe SVG icons as base64 data URIs for use in HTML email templates
// These icons are designed to work across all major email clients

// Truck icon - Green (for shipment received)
export const ICON_TRUCK_GREEN = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/><path d="M15 18h2.586a1 1 0 0 0 .707-.293l3.414-3.414a1 1 0 0 0 .293-.707V13a1 1 0 0 0-1-1h-4v6z"/><circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/></svg>`)}`;

// Truck icon - Blue (for status changed)
export const ICON_TRUCK_BLUE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/><path d="M15 18h2.586a1 1 0 0 0 .707-.293l3.414-3.414a1 1 0 0 0 .293-.707V13a1 1 0 0 0-1-1h-4v6z"/><circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/></svg>`)}`;

// Truck icon - Orange (for releases/outbound)
export const ICON_TRUCK_ORANGE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#FD5A2A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/><path d="M15 18h2.586a1 1 0 0 0 .707-.293l3.414-3.414a1 1 0 0 0 .293-.707V13a1 1 0 0 0-1-1h-4v6z"/><circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/></svg>`)}`;

// Package icon - Green (for items received)
export const ICON_PACKAGE_GREEN = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16.5 9.4 7.5 4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.29 7 12 12 20.71 7"/><line x1="12" y1="22" x2="12" y2="12"/></svg>`)}`;

// Warning triangle - Red (for damage)
export const ICON_WARNING_RED = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="#fef2f2" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>`)}`;

// Red X Circle (for unable to complete)
export const ICON_X_CIRCLE_RED = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="#fef2f2" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>`)}`;

// Clipboard icon - Blue (for tasks)
export const ICON_CLIPBOARD_BLUE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M9 14l2 2 4-4"/></svg>`)}`;

// Clock alert - Red (for overdue)
export const ICON_CLOCK_RED = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="#fef2f2" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>`)}`;

// Check circle - Green (for completed/success)
export const ICON_CHECK_GREEN = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="#f0fdf4" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>`)}`;

// Location pin - Blue (for location changes)
export const ICON_LOCATION_BLUE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>`)}`;

// Document/Invoice - Orange (for invoices)
export const ICON_DOCUMENT_ORANGE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#FD5A2A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`)}`;

// Dollar circle - Green (for payments)
export const ICON_DOLLAR_GREEN = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="#f0fdf4" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"/><path d="M12 18V6"/></svg>`)}`;

// Wrench - Amber (for repairs)
export const ICON_WRENCH_AMBER = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>`)}`;

// User pickup - Green (for will call)
export const ICON_USER_GREEN = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`)}`;

// Magnifying glass - Blue (for inspection)
export const ICON_MAGNIFY_BLUE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>`)}`;

// Forklift - Gray (for warehouse ops)
export const ICON_FORKLIFT_GRAY = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12H5a2 2 0 0 0-2 2v5"/><circle cx="13" cy="19" r="2"/><circle cx="5" cy="19" r="2"/><path d="M8 19h3m5-17v17h6M6 12V7c0-1.1.9-2 2-2h3l5 5"/></svg>`)}`;

// Boxes/Package stack - Gray (for custom/generic)
export const ICON_BOXES_GRAY = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16.5 9.4 7.5 4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.29 7 12 12 20.71 7"/><line x1="12" y1="22" x2="12" y2="12"/></svg>`)}`;

// Hand truck/Dolly - Blue (for receiving)
export const ICON_DOLLY_BLUE = `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 18L6 6.5C6 5.11929 7.11929 4 8.5 4H8.5C9.88071 4 11 5.11929 11 6.5V8"/><path d="M6 18H4"/><path d="M6 18C6 19.6569 7.34315 21 9 21C10.6569 21 12 19.6569 12 18"/><rect x="11" y="6" width="8" height="10" rx="1"/></svg>`)}`;

// Export icon map for easy access by trigger event
export const EMAIL_ICONS = {
  truck_green: ICON_TRUCK_GREEN,
  truck_blue: ICON_TRUCK_BLUE,
  truck_orange: ICON_TRUCK_ORANGE,
  package_green: ICON_PACKAGE_GREEN,
  warning_red: ICON_WARNING_RED,
  x_circle_red: ICON_X_CIRCLE_RED,
  clipboard_blue: ICON_CLIPBOARD_BLUE,
  clock_red: ICON_CLOCK_RED,
  check_green: ICON_CHECK_GREEN,
  location_blue: ICON_LOCATION_BLUE,
  document_orange: ICON_DOCUMENT_ORANGE,
  dollar_green: ICON_DOLLAR_GREEN,
  wrench_amber: ICON_WRENCH_AMBER,
  user_green: ICON_USER_GREEN,
  magnify_blue: ICON_MAGNIFY_BLUE,
  forklift_gray: ICON_FORKLIFT_GRAY,
  boxes_gray: ICON_BOXES_GRAY,
  dolly_blue: ICON_DOLLY_BLUE,
} as const;

export type EmailIconKey = keyof typeof EMAIL_ICONS;

// Email template configuration for each trigger event
export interface EmailTemplateConfig {
  icon: EmailIconKey;
  accentColor: string;
  buttonColor: string;
  headerLine1: string;
  headerLine2: string;
  description: string;
  ctaText: string;
  ctaLink: string;
  includeItemsTable: boolean;
  isUrgent?: boolean;
}

// Template configurations for all 17 trigger events
export const EMAIL_TEMPLATE_CONFIGS: Record<string, EmailTemplateConfig> = {
  'shipment.received': {
    icon: 'truck_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Shipment',
    headerLine2: 'Received',
    description: 'Your shipment {{shipment_number}} from {{shipment_vendor}} has arrived and been processed at our facility. {{items_count}} items are now checked in.',
    ctaText: 'View Shipment',
    ctaLink: '{{shipment_link}}',
    includeItemsTable: true,
  },
  'shipment.status_changed': {
    icon: 'truck_blue',
    accentColor: '#2563eb',
    buttonColor: '#111111',
    headerLine1: 'Status',
    headerLine2: 'Updated',
    description: 'Shipment {{shipment_number}} status has been updated to {{shipment_status}}.',
    ctaText: 'View Shipment',
    ctaLink: '{{shipment_link}}',
    includeItemsTable: false,
  },
  'shipment.completed': {
    icon: 'check_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Shipment',
    headerLine2: 'Complete',
    description: 'Shipment {{shipment_number}} has been fully processed and completed. All {{items_count}} items have been received.',
    ctaText: 'View Details',
    ctaLink: '{{shipment_link}}',
    includeItemsTable: true,
  },
  'item.received': {
    icon: 'package_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Item',
    headerLine2: 'Received',
    description: 'Item {{item_id}} has been received and logged at {{item_location}}.',
    ctaText: 'View Item',
    ctaLink: '{{item_photos_link}}',
    includeItemsTable: false,
  },
  'item.damaged': {
    icon: 'warning_red',
    accentColor: '#dc2626',
    buttonColor: '#dc2626',
    headerLine1: 'Damage',
    headerLine2: 'Reported',
    description: 'A photo has been flagged as showing damage that requires your immediate attention.',
    ctaText: 'View Photos',
    ctaLink: '{{item_photos_link}}',
    includeItemsTable: false,
    isUrgent: true,
  },
  'item.location_changed': {
    icon: 'location_blue',
    accentColor: '#2563eb',
    buttonColor: '#111111',
    headerLine1: 'Item',
    headerLine2: 'Moved',
    description: 'Item {{item_id}} has been moved to a new location: {{item_location}}.',
    ctaText: 'View Item',
    ctaLink: '{{item_photos_link}}',
    includeItemsTable: false,
  },
  'task.created': {
    icon: 'clipboard_blue',
    accentColor: '#2563eb',
    buttonColor: '#111111',
    headerLine1: 'New Task',
    headerLine2: 'Created',
    description: 'A new {{task_type}} task has been created and is due on {{task_due_date}}.',
    ctaText: 'View Task',
    ctaLink: '{{task_link}}',
    includeItemsTable: true,
  },
  'task.assigned': {
    icon: 'clipboard_blue',
    accentColor: '#2563eb',
    buttonColor: '#111111',
    headerLine1: 'Task',
    headerLine2: 'Assigned',
    description: 'You have been assigned a {{task_type}} task due on {{task_due_date}}.',
    ctaText: 'View Task',
    ctaLink: '{{task_link}}',
    includeItemsTable: true,
  },
  'task.completed': {
    icon: 'check_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Task',
    headerLine2: 'Complete',
    description: 'The {{task_type}} task has been completed successfully by {{created_by_name}}.',
    ctaText: 'View Details',
    ctaLink: '{{task_link}}',
    includeItemsTable: true,
  },
  'task.overdue': {
    icon: 'clock_red',
    accentColor: '#dc2626',
    buttonColor: '#dc2626',
    headerLine1: 'Task',
    headerLine2: 'Overdue',
    description: 'This task was due on {{task_due_date}} and requires immediate attention.',
    ctaText: 'Complete Task Now',
    ctaLink: '{{task_link}}',
    includeItemsTable: true,
    isUrgent: true,
  },
  'release.created': {
    icon: 'truck_orange',
    accentColor: '#FD5A2A',
    buttonColor: '#111111',
    headerLine1: 'Release',
    headerLine2: 'Created',
    description: 'A {{release_type}} release has been created with {{items_count}} items. Amount due: {{amount_due}}.',
    ctaText: 'View Release',
    ctaLink: '{{release_link}}',
    includeItemsTable: true,
  },
  'release.approved': {
    icon: 'check_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Release',
    headerLine2: 'Approved',
    description: 'Release {{release_number}} has been approved and is ready for processing.',
    ctaText: 'View Release',
    ctaLink: '{{release_link}}',
    includeItemsTable: true,
  },
  'release.completed': {
    icon: 'check_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Release',
    headerLine2: 'Complete',
    description: 'Release {{release_number}} has been completed on {{release_completed_at}}.',
    ctaText: 'View Details',
    ctaLink: '{{release_link}}',
    includeItemsTable: true,
  },
  'invoice.created': {
    icon: 'document_orange',
    accentColor: '#FD5A2A',
    buttonColor: '#FD5A2A',
    headerLine1: 'New',
    headerLine2: 'Invoice',
    description: 'A new invoice has been created for your account. Amount due: {{amount_due}}.',
    ctaText: 'View Invoice',
    ctaLink: '{{portal_base_url}}',
    includeItemsTable: false,
  },
  'invoice.sent': {
    icon: 'document_orange',
    accentColor: '#2563eb',
    buttonColor: '#111111',
    headerLine1: 'Invoice',
    headerLine2: 'Sent',
    description: 'Your invoice has been sent to {{account_contact_email}}.',
    ctaText: 'View Invoice',
    ctaLink: '{{portal_base_url}}',
    includeItemsTable: false,
  },
  'payment.received': {
    icon: 'dollar_green',
    accentColor: '#16a34a',
    buttonColor: '#111111',
    headerLine1: 'Payment',
    headerLine2: 'Received',
    description: 'We have received your payment. Thank you for your business!',
    ctaText: 'View Account',
    ctaLink: '{{portal_base_url}}',
    includeItemsTable: false,
  },
  'custom': {
    icon: 'boxes_gray',
    accentColor: '#6b7280',
    buttonColor: '#111111',
    headerLine1: 'Alert',
    headerLine2: 'Notification',
    description: 'This is a notification from {{tenant_name}}.',
    ctaText: 'View Details',
    ctaLink: '{{portal_base_url}}',
    includeItemsTable: false,
  },
};

// Build the Cowboy-inspired email template HTML
export function buildEmailTemplate(triggerEvent: string): string {
  const config = EMAIL_TEMPLATE_CONFIGS[triggerEvent] || EMAIL_TEMPLATE_CONFIGS['custom'];
  const iconDataUri = EMAIL_ICONS[config.icon];
  
  const urgentBanner = config.isUrgent ? `
              <!-- Urgent Banner -->
              <div style="background-color:${config.accentColor};color:#ffffff;padding:12px 24px;text-align:center;font-weight:600;font-size:14px;letter-spacing:0.5px;">
                ‚ö†Ô∏è URGENT - ACTION REQUIRED
              </div>` : '';

  return `<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${config.headerLine1} ${config.headerLine2}</title>
</head>
<body style="margin:0;padding:0;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;-webkit-font-smoothing:antialiased;">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="min-height:100vh;background-color:#f5f5f5;">
    <tr>
      <td align="center" style="padding:40px 20px;">
        <table width="600" cellpadding="0" cellspacing="0" border="0" style="max-width:600px;width:100%;">
          
          <!-- Logo Header -->
          <tr>
            <td style="padding:32px 40px;text-align:center;">
              <img src="{{brand_logo_url}}" alt="{{tenant_name}}" style="max-height:32px;max-width:200px;" onerror="this.style.display='none'">
            </td>
          </tr>
          
          <!-- Main Content Card -->
          <tr>
            <td>
              <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:#ffffff;border-radius:16px;overflow:hidden;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);">
                ${urgentBanner}
                <!-- Accent Bar -->
                <tr>
                  <td style="background-color:${config.accentColor};height:4px;"></td>
                </tr>
                
                <!-- Content -->
                <tr>
                  <td style="padding:48px 40px;text-align:center;">
                    
                    <!-- Icon -->
                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                      <tr>
                        <td align="center" style="padding-bottom:32px;">
                          <img src="${iconDataUri}" width="64" height="64" alt="" style="display:block;">
                        </td>
                      </tr>
                    </table>
                    
                    <!-- Bold Split Headline -->
                    <h1 style="margin:0;font-size:42px;font-weight:700;color:#111111;line-height:1.1;letter-spacing:-0.5px;">
                      ${config.headerLine1}<br>${config.headerLine2}
                    </h1>
                    
                    <!-- Description -->
                    <p style="margin:24px auto 32px;font-size:16px;color:#6b7280;line-height:1.6;max-width:400px;">
                      ${config.description}
                    </p>
                    
                    <!-- CTA Button -->
                    <table cellpadding="0" cellspacing="0" border="0" style="margin:0 auto;">
                      <tr>
                        <td style="background-color:${config.buttonColor};border-radius:24px;">
                          <a href="${config.ctaLink}" target="_blank" style="display:inline-block;padding:16px 32px;color:#ffffff;text-decoration:none;font-weight:600;font-size:15px;letter-spacing:0.3px;">
                            ${config.ctaText}
                          </a>
                        </td>
                      </tr>
                    </table>
                    
                    <!-- Info Card -->
                    <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-top:40px;">
                      <tr>
                        <td style="background-color:#f9fafb;border-radius:12px;padding:24px;text-align:left;">
                          <table width="100%" cellpadding="0" cellspacing="0" border="0" style="font-size:14px;">
                            <tr>
                              <td style="padding:6px 0;color:#6b7280;width:120px;">Account:</td>
                              <td style="padding:6px 0;color:#111111;font-weight:500;">{{account_name}}</td>
                            </tr>
                            <tr>
                              <td style="padding:6px 0;color:#6b7280;">Date:</td>
                              <td style="padding:6px 0;color:#111111;font-weight:500;">{{created_at}}</td>
                            </tr>
                            <tr>
                              <td style="padding:6px 0;color:#6b7280;">Items:</td>
                              <td style="padding:6px 0;color:#111111;font-weight:500;">{{items_count}}</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                    
                    ${config.includeItemsTable ? `
                    <!-- Items Table -->
                    <div style="margin-top:32px;text-align:left;">
                      <p style="margin:0 0 16px;font-size:14px;font-weight:600;color:#111111;">Items:</p>
                      {{items_table_html}}
                    </div>
                    ` : ''}
                    
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          
          <!-- Footer -->
          <tr>
            <td style="padding:40px 20px;text-align:center;">
              <p style="margin:0 0 12px;font-size:13px;color:#9ca3af;">
                Questions? Contact us at <a href="mailto:{{brand_support_email}}" style="color:#6b7280;text-decoration:underline;">{{brand_support_email}}</a>
              </p>
              <p style="margin:0;font-size:12px;color:#9ca3af;">
                ¬© {{tenant_name}}
              </p>
            </td>
          </tr>
          
        </table>
      </td>
    </tr>
  </table>
</body>
</html>`;
}

// Build SMS template
export function buildSmsTemplate(triggerEvent: string): string {
  const config = EMAIL_TEMPLATE_CONFIGS[triggerEvent] || EMAIL_TEMPLATE_CONFIGS['custom'];
  const urgentPrefix = config.isUrgent ? 'üö® URGENT: ' : '';
  
  return `${urgentPrefix}{{tenant_name}}: ${config.headerLine1} ${config.headerLine2}

${config.description.replace(/{{/g, '').replace(/}}/g, '').substring(0, 80)}...

{{items_count}} item(s).

View: {{portal_base_url}}`;
}
